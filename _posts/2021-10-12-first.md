---
title:  "경사하강법(Gradient Descent)"

categories:
  - AI
last_modified_at: 2021-10-12T08:06:00-05:00

---





아래와 같은 함수에서 극값(극소값)을 찾을 수 있는가?



![](/assets/image/gradient_descent/이차함수.png)

간단한 이차함수이므로 쉽게 극소점을 지정할 수 있다.

x에서 y로의 함수라고 한다면 x가 4일 때 y는 0이며, 이는 극소값이다.

그렇다면 함수가 더욱 더 복잡해지면 어떻게 해야할까? 

극값을 찾는 방법으로 경사하강법을 소개할 것이다.









![](/assets/image/gradient_descent/이차함수2.png)

임의의 x값을 하나 지정한다. 

이 경우에는 8이 되겠다.

경사하강법을 요약하자면,

어떤 위치에서 미분게수를 구하여 빼는 것을 반복하면 극소점에 가까워진다는 것이다.

다시말해, x에서 기울기를 빼주면 f(x)는 작아진다는 뜻이다.

이렇게 말하면 이해할 수 없으니 예시를 들어보겠다.









![](/assets/image/gradient_descent/이차함수3.png)

보다시피 위 그림은 미분계수가 양수인 경우이다.

미분은 어떤 점에서의 접점의 기울기로 생각할 수 있는데, 

위 경우에는 미분계수(기울기)가 양수라는 것이다.

앞서 언급한 것처럼 경사하강법의 아이디어는 이 미분계수(기울기)를 빼주는 것이다.

이것을 뺐을 때 어떻게 되는가?

양수를 뺐으니 당연하게도 음수가 된다.

이는 x가 음의 방향(좌측)으로 이동한다는 것이다.

기울기가 2라고 하면 이것을 빼주었을 때 x-2 이므로 x가 좌측으로 이동한다는 것을 볼 수 있다.

x가 좌측으로 이동함으로서 함수값은 작아지고 극소점에 가까워지게 된다.









![](/assets/image/gradient_descent/이차함수4.png)

미분계수(기울기)가 음수일 경우에도 마찬가지의 상황이다.

음수를 뺐을 때는 양수가 된다.

기울기가 -3이라고 하면 x-(-3)인데, 이것은 x+3이므로 

x는 양의 방향(우측)으로 이동하여 극소점에 가까워진다.



미분한 값, 즉 기울기를 빼줌으로서 극값에 가까워진다는 발상은 이해가 되었을 것이다.

하지만 기울기가 큰 값이 나온다면 어떻게 될까?

기울기가 만약에 100이 나온다면, 이것을 뺐을 때 x-100과 같이 큰 변화가 나타난다.

계속해서 뺀다고 해도 x가 극소값을 지나쳐서 좌우로 요동치게 될 것이다.



이러한 문제를 해결하기 위해 미분계수에 어떠한 작은 값(0.01 등)을 곱하여 빼주게 된다.

이를 통해 아주 천천히 극소값에 다가가게 된다.



이렇게 경사하강의 의미에 대한 설명은 끝났다.

이제 이것을 수학적으로 표현할 수 있다.



*x* := *x* − *α* ⋅ ▽*f*(*x*)



▽*f*(*x*)는 기울기(경사)를 나타낸다.

이것에 앞서 말한 아주 작은 값, α를 곱한 후 x에서 뺌으로서 경사하강이 진행된다.

정교한 업데이트를 위해 α를 곱했기 때문에 한번의 업데이트로 극소점에 가까워지는 것은 힘들며,

이것을 여러번 반복함으로서 점점 근사하게 된다.




