---
title:  "경사하강법(Gradient Descent)"

categories:
  - Machine Learning
last_modified_at: 2021-10-12T08:06:00-05:00

---

아래와 같은 함수에서 극값(극소값)을 찾을 수 있는가?

![](/assets/image/gradient_descent/이차함수.png)

간단한 이차함수이므로 쉽게 극소점을 지정할 수 있다. 
$x$에서 $y$로의 함수라고 한다면 $x$가 4일 때 $y$는 0이며, 
이는 극소값이다. 그렇다면 함수가 더욱 더 복잡해진다면 
어떻게 해야하는가? 이에 대한 방안으로 경사하강법을 
소개할 것이다.

![](/assets/image/gradient_descent/이차함수2.png)

임의의 $x$값을 하나 지정한다. 이 경우에는 8이 된다.
경사하강법을 요약하자면, 어떠한 한 위치에서의 미분계수를 구하여 
빼는 것을 반복하면 극소점에 가까워진다는 것이다.
다시말해, $x$에서의 기울기를 $x$에서 빼주면 
$f(x)$는 작아진다는 뜻이다. 예시를 들어보겠다.

![](/assets/image/gradient_descent/이차함수3.png)

보다시피 위 그림은 미분계수가 양수인 경우이다.
미분은 어떤 점에서의 접선의 기울기로 생각할 수 있는데, 
위 경우에는 기울기(미분계수)가 양수라는 것이다.
앞서 언급한 것처럼 경사하강법의 아이디어는 
이 기울기를 빼주는 것이다.

이것을 뺐을 때 어떻게 되는가?
양수를 뺐으므로 당연하게도 음수가 된다.
이는 $x$가 음의 방향(좌측)으로 이동한다는 것이다.
기울기가 2라고 하면 이것을 빼주었을 때 $x-2$ 이므로 
$x$가 좌측으로 2만큼 이동한다는 것을 볼 수 있다.
$x$가 좌측으로 이동함으로서 함수값은 
작아지고 극소점에 가까워지게 된다.

![](/assets/image/gradient_descent/이차함수4.png)

미분계수(기울기)가 음수일 경우에도 마찬가지의 상황이다.
음수를 뺐을 때는 양수가 된다.
기울기가 -2이라고 하면 이것을 뺐을 때 $x-(-3)$인데, 
이것은 $x+2$이므로 $x$는 양의 방향(우측)으로 2만큼 
이동하여 극소점에 가까워진다.

미분한 값, 즉 기울기를 빼줌으로서 
극값에 가까워진다는 발상은 이해가 되었을 것이다.
하지만 기울기가 매우 큰 값이 나온다면 어떻게 될까?

기울기가 만약에 100이 나온다면, 
이것을 뺐을 때 $x-100$과 같이 큰 변화가 나타난다.
계속해서 뺀다고 해도 $x$가 극소값을 지나쳐서 
좌우로 요동치게 될 것이다.

이러한 문제를 해결하기 위해 미분계수에 
어떠한 작은 값(0.01 등)을 곱한 후 빼주게 된다.
이를 통해 아주 천천히, 또한 정밀하게 
극소값에 다가가게 된다.

이렇게 경사하강의 의미에 대한 설명은 끝났다.
이제 이것을 수학적으로 표현할 수 있다.

$x \; \colon= x - \alpha \frac{df(x)}{dx}$

$\frac{df(x)}{dx}$는 기울기를 나타낸다.
이것에 앞서 말한 아주 작은 값, 
$\alpha$를 곱한 후 $x$에서 뺌으로서 
경사하강이 진행된다. 정교한 작은 폭의 업데이트를 위해 
$\alpha$를 곱했기 때문에 한번의 업데이트로 
극소점에 바로 다다르지 못하며, 이것을 여러번
반복함으로서 점점 근사된 값을 가지게 된다.


